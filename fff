pipeline {
     agent any
     
     environment {
        NEXT_VERSION = nextVersion(writeVersion: false)
    }
    
    stages {
        stage('Update Version') { 
  
           steps {
                          
             echo "next version = ${NEXT_VERSION}"  
             bat 'node version-updater.js %NEXT_VERSION%'
             withCredentials([gitUsernamePassword(credentialsId: 'github', gitToolName: 'git-tool')]) {
             bat '''
           
          
             git add .  
             git commit -m "Update Version" 
              bat 'git push'
             '''
             
              }
             
           }
        }
    }
}
