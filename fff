pipeline {
     agent {
        node {
        label ''
        customWorkspace 'Test/'
        }
     }
     
     environment {
        NEXT_VERSION = nextVersion(writeVersion: false)
    }
    
    stages {
        stage('Update Version') { 
  
           steps {
                          
             echo "next version = ${NEXT_VERSION}"  
             echo "Current workspace is ${env.WORKSPACE}"
             bat 'node version-updater.js %NEXT_VERSION%'
           
    
             withCredentials([gitUsernamePassword(credentialsId: 'github',
                 gitToolName: 'git-tool')]) {
                             bat '''
    
             git remote set-url origin https://alimob7ark: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@github.com/alimob7ark/Test.git
             git config --get user.email
             git config --get user.name
             git add .  
             git commit -m "Update Version" 
              
             '''
  bat 'git.exe push -f origin main'
            }

             
              
             
           }
        }
    }
}
